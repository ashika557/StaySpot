{% load i18n static %}

{% if result_hidden_fields %}
<div class="hiddenfields">
    {% for item in result_hidden_fields %}
    {{ item }}
    {% endfor %}
</div>
{% endif %}

{% if results %}
<div class="results">
    <table id="result_list" style="width: 100%; border-collapse: separate; border-spacing: 0;">
        <thead>
            <tr>
                {% for header in result_headers %}
                <th scope="col" {{ header.class_attrib }}
                    style="padding: 16px 24px; text-align: left; background: #F8FAFC; border-bottom: 2px solid #E2E8F0; color: #64748B; font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em;">
                    <div class="text">
                        {% if header.sortable %}
                        <a href="{{ header.url_primary }}" style="color: inherit; text-decoration: none;">
                            {{ header.label|capfirst }}
                        </a>
                        {% else %}
                        <span>
                            {{ header.label|capfirst }}
                        </span>
                        {% endif %}
                    </div>
                </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for result in results %}
            <tr class="result-row" style="transition: all 0.2s; border-bottom: 1px solid #F1F5F9;">
                {% for item in result %}
                <td style="padding: 14px 24px; vertical-align: middle; color: #1E293B; font-size: 13.5px;">
                    {{ item }}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const rows = document.querySelectorAll('#result_list tbody tr');
        rows.forEach(row => {
            if (row.innerHTML.includes('Flagged')) {
                row.style.background = '#FFF1F2';
            }
            const originalBg = row.style.background || 'white';
            row.addEventListener('mouseenter', () => {
                row.style.background = row.innerHTML.includes('Flagged') ? '#FFE4E6' : '#F8FAFC';
            });
            row.addEventListener('mouseleave', () => {
                row.style.background = originalBg;
            });
        });
    });
</script>
{% endif %}

<style>
    #result_list thead th.action-checkbox-column {
        width: 1.5em;
    }

    #result_list tbody td.action-checkbox {
        padding-left: 24px !important;
    }

    .results table thead th.sorted .text {
        color: #2563EB;
    }
</style>